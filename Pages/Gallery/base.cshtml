@page "/gallery/{baseAvatar}"
@model GalleryBasePageModel

@{
  var baseFilter = Model.BaseFilter;
  ViewData["Title"] = $"Free {baseFilter[0].ToString().ToUpper() + baseFilter[1..]} Avatar Downloads";
  Avatar[]? avatars = Model.Avatars;
  var bases = Model.BaseAvatars;
}

<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>@ViewData["Title"]</title>

  <meta name="description"
    content="Browse our AI-generated avatar gallery. See creative and unique avatars made in seconds with our free online avatar generator." />
  <meta name="keywords"
    content="AI avatars, avatar gallery, online avatar generator, profile pictures, digital art, AI images" />

  <meta property="og:title" content="Avatar Gallery" />
  <meta property="og:description"
    content="Explore AI-generated avatars created by our users. Discover unique designs for your online persona." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://onlineavatargenerator.com/gallery" />
  <meta property="og:image" content="https://onlineavatargenerator.com/imags/gallery_showcase.png" />
  <meta property="og:site_name" content="OnlineAvatarGenerator" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Avatar Gallery - OnlineAvatarGenerator" />
  <meta name="twitter:description"
    content="Explore AI-generated avatars created by our users. Discover unique designs for your online persona." />
  <meta name="twitter:image" content="https://onlineavatargenerator.com/og-gallery.jpg" />
</head>

<body class="min-h-screen bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-slate-100 transition">
  <div class="tw-test hidden bg-red-600 text-white px-4 py-2 text-sm">tailwind not loaded</div>

  <script>
    function toggleMobileNav(show) {
      const overlay = document.getElementById('mobile-nav');
      if (!overlay) return;
      if (show === true) overlay.classList.remove('hidden');
      else if (show === false) overlay.classList.add('hidden');
      else overlay.classList.toggle('hidden');
    }

    document.addEventListener('keydown', e => {
      if (e.key === 'Escape') toggleMobileNav(false);
    });
  </script>

  <div class="max-w-6xl mx-auto px-4 py-8 sm:py-12">
  <header class="mb-6 sm:mb-8">
  <div class="flex flex-col sm:flex-row sm:items-end justify-between gap-3">
    <div class="flex flex-col sm:flex-row sm:items-center gap-4">
      <a href="/" class="inline-flex items-center justify-center gap-2 px-4 py-2 rounded-lg font-medium
                     bg-brand text-white hover:bg-brand-700 shadow-bubble order-first sm:order-none">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
          class="lucide lucide-chevron-left-icon lucide-chevron-left">
          <path d="m15 18-6-6 6-6" />
        </svg>
        Back
      </a>
      <div>
        <h1 class="text-3xl font-bold tracking-tight">Avatar Gallery</h1>
        @if (avatars?.Length > 0 && avatars != null)
        {
          <p class="mt-1 text-sm text-slate-600 dark:text-slate-300">
            Here @(avatars.Length == 1 ? "is": "are") @(avatars.Length) of the most recent @(baseFilter ?? "") avatars generated
          </p>
        }
      </div>
    </div>
  </div>
</header>

    <div class="md:hidden mb-4">
      <label for="base-select" class="sr-only">choose a base</label>
      <select id="base-select"
        class="w-full rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 px-3 py-2"
        onchange="var v=this.value; if(v) location.href='/gallery/'+encodeURIComponent(v.toLowerCase());">
        <option value="" selected disabled>Select a base</option>
        @foreach (var b in bases)
        {
          <option value="@b">@b</option>
        }
      </select>
    </div>

    <div class="grid @(avatars?.Length > 0 ? "md:grid-cols-[18rem,1fr]" : "grid-cols-1") gap-6">
      <aside class="@(avatars?.Length == 0 ? "mx-auto" : "hidden md:block")">
        <nav class="@(avatars?.Length == 0 
                                    ? "flex flex-wrap justify-center gap-2 p-4 bg-white dark:bg-slate-800 rounded-bubble shadow-bubble" 
                                    : "sticky top-6 bg-white dark:bg-slate-800 rounded-bubble shadow-bubble p-4")">
          <h2
            class="text-sm font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 mb-3 text-center w-full">
            base avatars
          </h2>
          <ul class="@(avatars?.Length == 0 ? "flex flex-wrap justify-center gap-2" : "space-y-1")">
            @foreach (var b in bases)
            {
              <li>
                <a class="block px-3 py-2 rounded-md hover:bg-slate-100 dark:hover:bg-slate-700"
                  href="/gallery/@(b.ToLower())">
                  @b
                </a>
              </li>
            }
          </ul>
        </nav>
      </aside>

      @if (avatars?.Length > 0)
      {
        <main>
          <a href="/" class="sm:hidden mb-4 inline-flex items-center justify-center gap-2 px-4 py-2 rounded-lg font-medium
                       bg-brand text-white hover:bg-brand-700 shadow-bubble">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="m15 18-6-6 6-6" />
            </svg>
            back to generator
          </a>

          <section class="space-y-6">
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
              @foreach (var avatar in avatars)
              {
                <figure class="bg-white dark:bg-slate-800 rounded-bubble shadow-bubble p-4">
                  <a href="@avatar.ImageUrl" target="_blank" rel="noopener">
                    <img src="@avatar.ImageUrl" class="rounded-lg w-full" alt="@avatar.ImgageDetails.Adjective @avatar.ImgageDetails.Base with a
                                @avatar.ImgageDetails.Aesthetic aesthetic" />
                  </a>
                </figure>
              }
            </div>
          </section>
        </main>
      }
      else
      {
        <main>
          <p class="text-center text-slate-500 dark:text-slate-400">No avatars found for this category.</p>
        </main>
      }
    </div>
  </div>

  <div id="mobile-nav" class="fixed inset-0 z-50 hidden">
    <div class="absolute inset-0 bg-black/50" onclick="toggleMobileNav(false)"></div>

    <div class="absolute inset-y-0 left-0 w-80 max-w-[85%] bg-white dark:bg-slate-800 shadow-xl p-4 overflow-y-auto">
      <div class="flex items-center justify-between mb-2">
        <h2 class="text-base font-semibold">base avatars</h2>
        <button class="p-2 rounded-md hover:bg-slate-100 dark:hover:bg-slate-700" onclick="toggleMobileNav(false)"
          aria-label="close">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor"
            stroke-width="2">
            <path d="M18 6 6 18M6 6l12 12" />
          </svg>
        </button>
      </div>

      <nav>
        <ul class="space-y-1">
          @foreach (var b in bases)
          {
            <li>
              <a class="block px-3 py-2 rounded-md hover:bg-slate-100 dark:hover:bg-slate-700" href="/?base=@b"
                onclick="toggleMobileNav(false)">
                @b
              </a>
            </li>
          }
        </ul>
      </nav>
    </div>
  </div>
</body>

</html>
